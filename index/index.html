<!DOCTYPE html>
<html lang="en">

<head>
	<style>
	
	p{
		margin: 20px;
	}
	
	body{
		zoom: 200%;
		background-image: url('background.png');
		background-size: cover;
		background-repeat: no-repeat;
		<!-- background-color: lightseagreen; -->
		
		margin: 20px;
		<!-- background-image: url('smiley.png'); -->
		
		
		
		
	}
	body, h1, h2, h3, h4, h5, h6  {
		font-family: "Trebuchet MS", Tahoma, sans-serif;
	}
	select, input, button {
		font-family: "Trebuchet MS", Tahoma, sans-serif;
	}
	</style>
  <meta charset="utf-8">
  
  <title>SLA CALCULATOR</title>
  <link rel="icon" type="image/x-icon" href="favicon.ico">

</head>
<body>
	<h2>SLA CALCULATOR</h2>
	<label for="department">Department:</label> 
	<select id="department">
		<option value="walmart">Walmart</option>
		<option value="sams">Sam's Club</option>
		<option value="DMS">DMS</option>
		<option value="vision">Vision Center</option>
		<option value="pharma">Pharmacy</option>
	</select> 
	<label for="weekend">Exclude Weekends?</label> 
	<input id="weekend" type="checkbox">(Unnecessary if you chose DMS)</input>
	<!-- <p style="background-image: url('smiley.png');"> -->
	
	<br><br><br>
	
	<label for="priority">Priority (in hours):</label>
	<input id="priority">
	
	</br>
	</br>
	</br>
	
	<label for="assigned">Assigned Date/Time:</label>
	<input id="assigned">
	
	<br><br><br>
	
	<button type="button" onclick="input()">CALCULATE SLA</button>
	
	<a href="https://www.iww.org" target="_blank" style="float:right" <p> </p></a>
	
	<br>
	<br>
	<br><br>
	<p id="demo"></p>
	

  <script>
	function skipweekend(dateThing, startTime){
		while ([0, 6].includes(dateThing.getDay())) {
			dateThing.setDate(dateThing.getDate() + 1);
			dateThing.setHours(startTime, 0, 0, 0);
		}
		return dateThing;
	}
	function input() {
		
		

		let assigned = new Date(document.getElementById("assigned").value);
		//DMS(assigned); -->
		//assigned.setTime(assigned.getTime() + hoursToAdd); -->
		//document.getElementById("demo").innerHTML = "New SLA due date: " + assigned; -->
		if(document.getElementById("department").value == "DMS"){
			DMS(assigned, document.getElementById("priority").value);
		}
		if(document.getElementById("department").value == "walmart"){
			Walmart(assigned, document.getElementById("priority").value);
		}
		if(document.getElementById("department").value == "sams"){
			Sams(assigned, document.getElementById("priority").value);
		}
		if(document.getElementById("department").value == "vision"){
			vision(assigned, document.getElementById("priority").value);
		}
		if(document.getElementById("department").value == "pharma"){
			pharma(assigned, document.getElementById("priority").value);
		}
	}
	
	function Walmart(dtime, hours) {
		let result = new Date(dtime.getTime());
		const minutesToAdd = hours * 60;
		let minutesAdded = 0;


		while (minutesAdded < minutesToAdd) {
		
			if (document.getElementById("weekend").checked == true){
				result = skipweekend(result, 6);
			}
			// Skip excluded hours
			const hour = result.getHours();
			if (hour < 6) {
				result.setHours(6, 0, 0, 0); // Start of business day
			} else if (hour >= 23) {
				result.setDate(result.getDate() + 1); // Next day
				result.setHours(6, 0, 0, 0);
				if (document.getElementById("weekend").checked == true){
					continue;
				}
			}
			// Add a minute of business time
			result.setMinutes(result.getMinutes() + 1);
			minutesAdded++;
		}
	document.getElementById("demo").innerHTML = "New SLA due date: " + result.toLocaleString();
	}
	
	function Sams(dtime, hours) {
		let result = new Date(dtime.getTime());
		const minutesToAdd = hours * 60;
		let minutesAdded = 0;


		while (minutesAdded < minutesToAdd) {
		// Skip excluded hours
		if (document.getElementById("weekend").checked == true){
				result = skipweekend(result, 8);
			}
		const hour = result.getHours();
			if (hour < 8) {
				result.setHours(8, 0, 0, 0); // Start of business day
			} else if (hour >= 20) {
				result.setDate(result.getDate() + 1); // Next day
				result.setHours(8, 0, 0, 0);
				if (document.getElementById("weekend").checked == true){
					continue;
				}
			}
			// Add a minute of business time
			result.setMinutes(result.getMinutes() + 1);
			minutesAdded++;
			
		}
		document.getElementById("demo").innerHTML = "New SLA due date: " + result.toLocaleString();
	}
	
	function DMS(dtime, hours) {
		let result = new Date(dtime);
		const minutesToAdd = hours * 60;
		let minutesAdded = 0;

		while (minutesAdded < minutesToAdd) {
		// Skip excluded days
			while ([0, 6].includes(result.getDay())) {
				result.setDate(result.getDate() + 1);
				result.setHours(8, 0, 0, 0); // Reset to next weekday at 8 AM
			}

		// Skip excluded hours
		const hour = result.getHours();
		if (hour < 8) {
			result.setHours(8, 0, 0, 0); // Start of business day
			} else if (hour >= 17) {
				result.setDate(result.getDate() + 1); // Next day
				result.setHours(8, 0, 0, 0);
				continue; // Recheck day after date advance
			}

			// Add a minute of business time
			result.setMinutes(result.getMinutes() + 1);
			minutesAdded++;
		}

	document.getElementById("demo").innerHTML = "New SLA due date: " + result.toLocaleString();
	}
	
	function vision(dtime, hours){
		let result = new Date(dtime.getTime());
		const minutesToAdd = hours * 60;
		let minutesAdded = 0;


		while (minutesAdded < minutesToAdd) {
		
			if (document.getElementById("weekend").checked == true){
				result = skipweekend(result, 10);
			}
		
		// Skip excluded hours
		const hour = result.getHours();
			if (hour < 10) {
				result.setHours(10, 0, 0, 0); // Start of business day
			} else if (hour >= 19) {
				result.setDate(result.getDate() + 1); // Next day
				result.setHours(10, 0, 0, 0);
				if (document.getElementById("weekend").checked == true){
					continue;
				}
			}
			// Add a minute of business time
			result.setMinutes(result.getMinutes() + 1);
			minutesAdded++;
		}
		document.getElementById("demo").innerHTML = "New SLA due date: " + result.toLocaleString();
	}
	
	function pharma(dtime, hours){
		let result = new Date(dtime.getTime());
		const minutesToAdd = hours * 60;
		let minutesAdded = 0;


		while (minutesAdded < minutesToAdd) {
			if (document.getElementById("weekend").checked == true){
				result = skipweekend(result, 9);
			}
		// Skip excluded hours
			const hour = result.getHours();
				if (hour < 9) {
					result.setHours(9, 0, 0, 0); // Start of business day
				} else if (hour >= 19) {
					result.setDate(result.getDate() + 1); // Next day
					result.setHours(9, 0, 0, 0);
					if (document.getElementById("weekend").checked == true){
						continue;
					}
				}
				// Add a minute of business time
			result.setMinutes(result.getMinutes() + 1);
			minutesAdded++;
		}
		document.getElementById("demo").innerHTML = "New SLA due date: " + result.toLocaleString();
	}
	

	
  </script>
  

</body>
</html>

